<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Judul Halaman Dinamis -->
    <title>Streamflix Now - Film dan Acara TV</title>
    
    <!-- Deskripsi Meta SEO -->
    <meta name="description" content="Temukan sinopsis, trailer, pemeran, dan detail film-film terbaru.">

    <!-- Tag Meta Open Graph (untuk Facebook) -->
    <meta property="og:site_name" content="Streamflix Now">
    <meta property="og:title" content="Judul Film Placeholder">
    <meta property="og:description" content="Deskripsi film placeholder">
    <meta property="og:url" content="https://streamflix-now.pages.dev/">
    <meta property="og:image" content="https://placehold.co/1200x630/000000/FFFFFF?text=Poster%20Film">
    <meta property="og:type" content="video.movie">
    <meta property="fb:app_id" content="100073133663144">

    <!-- Tag Meta Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@WatchStream123">
    <meta name="twitter:title" content="Judul Film Placeholder">
    <meta name="twitter:description" content="Deskripsi film placeholder">
    <meta name="twitter:image" content="https://placehold.co/1200x630/000000/FFFFFF?text=Poster%20Film">

    <!-- Favicon untuk browser -->
    <link rel="icon" href="https://placehold.co/32x32/000000/FFFFFF?text=SF" type="image/png">

    <!-- Muat font Roboto dari Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">

    <!-- Muat Tailwind CSS untuk styling yang mudah dan responsif -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            transition: background-color 0.3s, color 0.3s;
            font-family: 'Roboto', sans-serif;
        }
        /* Gaya responsif untuk iframe dan gambar */
        .media-container {
            position: relative;
            padding-bottom: 56.25%; /* Rasio aspek 16:9 */
            height: 0;
            overflow: hidden;
            border-radius: 0.75rem; /* rounded-lg */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .media-container iframe,
        .media-container img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover; /* Untuk gambar agar tidak terdistorsi */
        }
        .movie-card {
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .movie-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .genre-tag {
            display: inline-block;
            background-color: #e2e8f0;
            color: #4a5568;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px; /* full rounded */
            font-size: 0.875rem;
            font-weight: 500;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }
        /* Gaya untuk gambar yang dimuat secara malas (lazy-loaded) */
        img.lazy {
            background-color: #e2e8f0;
            opacity: 0.5;
            transition: opacity 0.5s ease-in-out;
        }
        img.lazy.loaded {
            opacity: 1;
        }
        .review-card-hover {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            cursor: pointer;
        }
        .review-card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        /* Gaya Loading Kerangka (Skeleton Loading) */
        .skeleton-loading {
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        /* Gaya kotak pesan modal */
        #message-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #2d3748;
            color: white;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.05);
            z-index: 100;
            max-width: 80%;
            text-align: center;
        }
        #message-box-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 99;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-900">

    <!-- Kontainer utama dengan padding dan tata letak responsif -->
    <div class="container mx-auto p-4 md:p-8">
        <!-- Header dengan nama blog, navigasi, dan tombol toggle tema -->
        <header class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
            <!-- Nama Blog (div) - Elemen penting untuk SEO -->
            <div id="home-button" class="text-4xl md:text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-green-500 cursor-pointer">
                Streamflix Now
            </div>

            <!-- Kontainer untuk navigasi dan pencarian, agar berdampingan -->
            <div class="flex flex-col md:flex-row items-center gap-4 w-full md:w-auto">
                <!-- Navigasi -->
                <nav class="flex-grow flex justify-center md:justify-start">
                    <button id="movies-nav" class="px-3 py-2 text-lg font-medium text-gray-700 hover:text-blue-500 transition-colors duration-200">Film</button>
                    <button id="tv-shows-nav" class="px-3 py-2 text-lg font-medium text-gray-700 hover:text-blue-500 transition-colors duration-200">Acara TV</button>
                </nav>

                <!-- Kotak pencarian -->
                <div class="flex items-center space-x-4 w-full md:w-auto">
                    <!-- Input pencarian -->
                    <form id="search-form" class="flex rounded-full bg-gray-200 overflow-hidden w-full">
                        <input type="text" id="search-input" placeholder="Cari film..." class="px-4 py-2 bg-transparent focus:outline-none w-full text-gray-800">
                        <button type="submit" class="p-2 bg-blue-500 text-white hover:bg-blue-600 transition-colors duration-200">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                            </svg>
                        </button>
                    </form>
                </div>
            </div>
        </header>

        <!-- Bagian konten film utama -->
        <main id="movie-content" class="bg-white p-6 rounded-xl shadow-lg">
            <!-- Konten akan dimuat di sini -->
        </main>
    </div>

    <!-- Kotak Modal untuk pesan, tidak menggunakan alert() -->
    <div id="message-box-overlay" class="hidden"></div>
    <div id="message-box" class="hidden">
        <p id="message-box-text" class="mb-4 text-center"></p>
        <button id="message-box-close" class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600">OK</button>
    </div>

    <script>
        // Konfigurasi dasar untuk SEO dan media sosial
        const BLOG_NAME = "Streamflix Now";
        const BLOG_URL = "https://streamflix-now.pages.dev/"; // Tetap URL absolut untuk meta tags
        // URL proxy API baru dari pengguna
        const TMDB_API_PROXY = `https://tmdb-api-proxy-1.musadekakhmad.workers.dev`;
        
        let currentPage = {}; // State untuk melacak halaman saat ini

        // =======================================================
        // FUNGSI UMUM & UTILITY
        // =======================================================

        // Fungsi untuk menampilkan pesan dalam modal kustom
        function showMessage(message) {
            const overlay = document.getElementById('message-box-overlay');
            const box = document.getElementById('message-box');
            const text = document.getElementById('message-box-text');
            
            text.textContent = message;
            overlay.classList.remove('hidden');
            box.classList.remove('hidden');

            document.getElementById('message-box-close').onclick = () => {
                overlay.classList.add('hidden');
                box.classList.add('hidden');
            };
        }

        // Fungsi untuk membersihkan judul agar sesuai untuk URL
        function cleanTitleForUrl(title) {
            return title.toLowerCase()
                        .replace(/[^a-z0-9\s-]/g, '') // Hapus karakter non-alfanumerik kecuali spasi dan tanda hubung
                        .replace(/\s+/g, '-')       // Ganti spasi dengan tanda hubung
                        .replace(/^-+|-+$/g, '');   // Hapus tanda hubung dari awal/akhir
        }

        // Fungsi untuk meng-escape tanda kutip tunggal untuk atribut HTML
        function escapeSingleQuotes(text) {
            return text.replace(/'/g, "\\'");
        }

        // Fungsi untuk memperbarui tag meta SEO dan media sosial
        function updateMetaTags(data, type, cleanTitle) {
            const title = type === 'movie' ? data.title : data.name;
            const overview = data.overview;
            const posterPath = data.poster_path;
            const urlSegment = type === 'movie' ? 'film' : 'acara-tv';
            // Gunakan BLOG_URL untuk URL absolut di meta tags
            const url = `${BLOG_URL}${urlSegment}/${cleanTitle}-${data.id}`;

            document.title = `${title} - ${BLOG_NAME}`;
            document.querySelector('meta[name="description"]').setAttribute('content', overview);
            document.querySelector('meta[property="og:title"]').setAttribute('content', title);
            document.querySelector('meta[property="og:description"]').setAttribute('content', overview);
            document.querySelector('meta[property="og:url"]').setAttribute('content', url);
            document.querySelector('meta[property="og:image"]').setAttribute('content', `https://image.tmdb.org/t/p/w500${posterPath}`);
            document.querySelector('meta[name="twitter:title"]').setAttribute('content', title);
            document.querySelector('meta[name="twitter:description"]').setAttribute('content', overview);
            document.querySelector('meta[name="twitter:image"]').setAttribute('content', `https://image.tmdb.org/t/p/w500${posterPath}`);
        }
        
        // Fungsi untuk menghasilkan JSON-LD (Data Terstruktur)
        function generateJsonLd(item, type, credits, cleanTitle) {
            const ldScript = document.querySelector('script[type="application/ld+json"]');
            if (ldScript) {
                ldScript.remove();
            }

            const schemaType = type === 'movie' ? 'Movie' : 'TVEpisode';
            const director = credits.crew ? credits.crew.find(crewMember => crewMember.job === "Director") : null; 
            const cast = credits.cast ? credits.cast.slice(0, 5).map(actor => ({ 
                "@type": "Person",
                "name": actor.name,
                "jobTitle": "Aktor",
                "url": `https://www.themoviedb.org/person/${actor.id}`
            })) : [];
            const genres = item.genres ? item.genres.map(genre => genre.name) : []; 
            const urlSegment = type === 'movie' ? 'film' : 'acara-tv';

            const jsonLdData = {
                "@context": "https://schema.org",
                "@type": schemaType,
                "name": item.title || item.name,
                "description": item.overview,
                // Gunakan BLOG_URL untuk URL absolut di JSON-LD
                "url": `${BLOG_URL}${urlSegment}/${cleanTitle}-${item.id}`,
                "image": `https://image.tmdb.org/t/p/original${item.poster_path}`,
                "datePublished": item.release_date || item.first_air_date,
                "director": director ? { "@type": "Person", "name": director.name } : null,
                "actor": cast,
                "genre": genres,
                "aggregateRating": {
                    "@type": "AggregateRating",
                    "ratingValue": item.vote_average ? item.vote_average.toFixed(1) : 'N/A', 
                    "bestRating": "10",
                    "ratingCount": item.vote_count || 0 
                }
            };
            
            const script = document.createElement('script');
            script.type = 'application/ld+json';
            script.textContent = JSON.stringify(jsonLdData);
            document.head.appendChild(script);
        }

        // Fungsi untuk mengonversi kode bahasa ISO 639-1 ke nama lengkap
        function getLanguageName(isoCode) {
            const languageNames = {
                "en": "Inggris", "id": "Indonesia", "ja": "Jepang", "ko": "Korea",
                "fr": "Prancis", "es": "Spanyol", "de": "Jerman", "zh": "China",
                "hi": "Hindi", "ru": "Rusia", "it": "Italia"
            };
            return languageNames[isoCode] || isoCode.toUpperCase();
        }

        // Fungsi untuk memformat angka sebagai mata uang
        function formatCurrency(number) {
            if (!number || number === 0) return 'N/A';
            return new Intl.NumberFormat('id-ID', {
                style: 'currency',
                currency: 'USD',
                maximumFractionDigits: 0,
            }).format(number);
        }

        // Fungsi untuk menyalin teks ke clipboard
        function copyToClipboard(text) {
            const tempInput = document.createElement('input');
            tempInput.value = text;
            document.body.appendChild(tempInput);
            tempInput.select();
            document.execCommand('copy');
            document.body.removeChild(tempInput);
            showMessage('URL berhasil disalin ke clipboard!');
        }

        // =======================================================
        // FUNGSI RENDERING
        // =======================================================
        
        // Render tampilan kerangka (skeleton) untuk satu kategori film
        function renderCategorySkeleton(title, endpoint) {
            const content = document.getElementById('movie-content');
            const categoryContainer = document.createElement('div');
            categoryContainer.id = `category-${endpoint}`;
            categoryContainer.className = 'mb-8';

            // Judul dan loading kerangka untuk kategori ini
            categoryContainer.innerHTML = `
                <h3 class="text-2xl font-bold mb-4">${title}</h3>
                <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4" id="grid-${endpoint}">
                    ${`<div class="movie-card bg-gray-200 rounded-lg overflow-hidden shadow-md">
                        <div class="bg-gray-300 w-full h-48 sm:h-64 md:h-72 lg:h-96 skeleton-loading"></div>
                        <div class="p-2 text-center">
                            <div class="bg-gray-300 h-4 w-3/4 mx-auto rounded skeleton-loading my-1"></div>
                            <div class="bg-gray-300 h-3 w-1/2 mx-auto rounded skeleton-loading"></div>
                        </div>
                    </div>`.repeat(12)}
                </div>
            `;
            content.appendChild(categoryContainer);
        }

        // Render tampilan kerangka (skeleton) untuk halaman detail
        function renderDetailsSkeleton() {
            const content = document.getElementById('movie-content');
            content.innerHTML = `
                <div class="text-center mb-6">
                    <div class="bg-gray-300 h-10 w-2/3 mx-auto rounded skeleton-loading mb-4"></div>
                    <div class="bg-gray-300 h-6 w-1/2 mx-auto rounded skeleton-loading mb-2"></div>
                </div>
                <div class="media-container mb-6 bg-gray-300 skeleton-loading"></div>
                <div class="flex flex-col md:flex-row items-start md:items-stretch gap-6">
                    <div class="flex-shrink-0 w-full md:w-1/3 lg:w-1/4 bg-gray-300 h-96 rounded-lg shadow-md skeleton-loading"></div>
                    <div class="flex-1">
                        <div class="bg-gray-300 h-8 w-1/4 rounded mb-4 skeleton-loading"></div>
                        <div class="bg-gray-300 h-4 rounded mb-2 skeleton-loading"></div>
                        <div class="bg-gray-300 h-4 rounded mb-2 skeleton-loading"></div>
                        <div class="bg-gray-300 h-4 rounded mb-2 skeleton-loading"></div>
                        <div class="bg-gray-300 h-4 rounded mb-6 w-3/4 skeleton-loading"></div>
                        
                        <div class="bg-gray-300 h-8 w-1/4 rounded mb-4 skeleton-loading"></div>
                        <div class="flex flex-wrap gap-2 mb-6">
                            ${`<div class="bg-gray-300 h-6 w-20 rounded-full skeleton-loading"></div>`.repeat(3)}
                        </div>
                    </div>
                </div>
                <div class="mt-8">
                    <div class="bg-gray-300 h-8 w-1/5 rounded mb-4 skeleton-loading"></div>
                    <div class="media-container bg-gray-300 skeleton-loading"></div>
                </div>
            `;
        }
        
        // Fungsi untuk menampilkan pesan kesalahan
        function renderError(message) {
            const content = document.getElementById('movie-content');
            content.innerHTML = `<p class="text-2xl text-red-500 text-center mt-12">${message}</p>`;
        }

        // =======================================================
        // FUNGSI PENGAMBILAN DATA
        // =======================================================

        // Fungsi untuk mengambil detail film/acara TV, video, kredit, tanggal rilis, dan ulasan secara bersamaan
        async function fetchContentDetails(id, type) {
            renderDetailsSkeleton();

            try {
                const [detailsResponse, videosResponse, creditsResponse, releaseDatesResponse, reviewsResponse] = await Promise.all([
                    fetch(`${TMDB_API_PROXY}/${type}/${id}`),
                    fetch(`${TMDB_API_PROXY}/${type}/${id}/videos`),
                    fetch(`${TMDB_API_PROXY}/${type}/${id}/credits`),
                    fetch(`${TMDB_API_PROXY}/${type}/${id}/release_dates`),
                    fetch(`${TMDB_API_PROXY}/${type}/${id}/reviews`) 
                ]);

                if (!detailsResponse.ok) {
                    throw new Error(`Konten dengan ID ${id} tidak ditemukan.`);
                }
                // Memeriksa respons untuk setiap permintaan secara individual
                if (!videosResponse.ok) console.error("Gagal mengambil data video.");
                if (!creditsResponse.ok) console.error("Gagal mengambil data kredit.");
                if (!releaseDatesResponse.ok) console.error("Gagal mengambil data tanggal rilis."); 
                if (!reviewsResponse.ok) console.error("Gagal mengambil data ulasan.");

                // Perbaikan: Hanya parse JSON jika respons OK, jika tidak, berikan objek kosong default
                const detailsData = await detailsResponse.json();
                const videosData = videosResponse.ok ? await videosResponse.json() : { results: [] };
                const creditsData = creditsResponse.ok ? await creditsResponse.json() : { cast: [], crew: [] };
                const releaseDatesData = releaseDatesResponse.ok ? await releaseDatesResponse.json() : { results: [] };
                const reviewsData = reviewsResponse.ok ? await reviewsResponse.json() : { results: [] };
                
                // Generate clean title for meta tags and JSON-LD
                const cleanTitle = cleanTitleForUrl(detailsData.title || detailsData.name);
                updateMetaTags(detailsData, type, cleanTitle);
                generateJsonLd(detailsData, type, creditsData, cleanTitle);
                renderDetails(detailsData, videosData, creditsData, releaseDatesData, reviewsData, type);
            } catch (error) {
                console.error("Gagal memuat data:", error);
                renderError('Gagal memuat detail konten. Silakan coba lagi nanti.');
            }
        }

        // Fungsi untuk merender detail film atau acara TV
        function renderDetails(item, videos, credits, releaseDates, reviews, type) {
            const content = document.getElementById('movie-content');
            const title = type === 'movie' ? item.title : item.name;
            const releaseDate = type === 'movie' ? item.release_date : item.first_air_date;
            
            const trailer = videos.results ? videos.results.find(video => video.site === "YouTube" && video.type === "Trailer") : null;
            const cast = credits.cast ? credits.cast.slice(0, 5) : [];
            const director = credits.crew ? credits.crew.find(crewMember => crewMember.job === "Director") : null;

            // Temukan klasifikasi audiens
            let certification = 'N/A';
            const releaseInfo = releaseDates.results && (releaseDates.results.find(rel => rel.iso_3166_1 === 'ID') || releaseDates.results.find(rel => rel.iso_3166_1 === 'US'));
            if (releaseInfo && releaseInfo.release_dates && releaseInfo.release_dates.length > 0) {
                certification = releaseInfo.release_dates[0].certification || 'N/A';
            }

            // Tampilkan ulasan (ambil 3 ulasan teratas)
            const reviewList = (reviews.results && reviews.results.length > 0) ? reviews.results.slice(0, 3).map(review => `
                <div class="bg-gray-100 p-4 rounded-lg shadow mb-4 review-card-hover">
                    <p class="font-semibold text-sm">${review.author}</p>
                    <p class="text-sm italic text-gray-600 text-justify line-clamp-3">${review.content}</p>
                </div>
            `).join('') : '';

            // Buat tag genre
            const genresHtml = item.genres ? item.genres.map(genre => `<li class="genre-tag">${genre.name}</li>`).join('') : '';

            // Atribut srcset untuk gambar yang lebih responsif
            const posterSrcset = item.poster_path ? `
                https://image.tmdb.org/t/p/w92${item.poster_path} 92w,
                https://image.tmdb.org/t/p/w185${item.poster_path} 185w,
                https://image.tmdb.org/t/p/w342${item.poster_path} 342w,
                https://image.tmdb.org/t/p/w500${item.poster_path} 500w
            ` : '';
            const backdropSrcset = item.backdrop_path ? `
                https://image.tmdb.org/t/p/w300${item.backdrop_path} 300w,
                https://image.tmdb.org/t/p/w780${item.backdrop_path} 780w,
                https://image.tmdb.org/t/p/w1280${item.backdrop_path} 1280w
            ` : '';

            // Dapatkan nama perusahaan produksi
            const productionCompanies = item.production_companies && item.production_companies.length > 0 
                ? item.production_companies.map(company => company.name).join(', ') 
                : 'N/A';

            // --- Perubahan tata letak di sini ---
            content.innerHTML = `
                <!-- Judul, Rating, dan Slogan Kontainer -->
                <div class="text-center mb-6">
                    <!-- Judul Film (h1) -->
                    <h1 class="text-3xl md:text-5xl font-extrabold text-blue-600">
                        ${title}
                    </h1>
                    <!-- Rating TMDB dan Skor Pengguna (h2) -->
                    <h2 class="text-lg md:text-xl font-bold flex items-center justify-center space-x-2 my-2">
                        <svg class="h-6 w-6 text-yellow-400" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2l3.09 6.31l6.91 1l-5 4.86l1.18 6.88L12 17l-6.18 3.25l1.18-6.88l-5-4.86l6.91-1L12 2z"/>
                        </svg>
                        <span>${item.vote_average ? item.vote_average.toFixed(1) : 'N/A'}</span>
                        <span class="text-gray-500 font-normal">(${item.vote_count ? item.vote_count.toLocaleString() : '0'} suara)</span>
                    </h2>
                    <!-- Slogan (h3) -->
                    <h3 class="text-lg md:text-xl font-medium italic text-gray-600">
                        ${item.tagline ? `"${item.tagline}"` : ''}
                    </h3>
                    
                    <!-- Tombol Aksi Baru -->
                    <div class="mt-4 flex justify-center space-x-4">
                        <button id="share-button" class="px-4 py-2 bg-green-500 text-white rounded-full hover:bg-green-600 transition-colors duration-200 flex items-center space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M15 8a3 3 0 10-2.977-2.63l-4.94 2.47a3 3 0 100 4.319l4.94 2.47a3 3 0 10.87-1.834l-4.94-2.47a3.003 3.003 0 000-1.834l4.94-2.47A3 3 0 0015 8z" />
                            </svg>
                            <span>Bagikan</span>
                        </button>
                        <button id="watchlist-button" class="px-4 py-2 bg-yellow-500 text-white rounded-full hover:bg-yellow-600 transition-colors duration-200 flex items-center space-x-2">
                             <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M10 2a8 8 0 100 16 8 8 0 000-16zM5 8a1 1 0 011-1h3V5a1 1 0 112 0v2h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 01-1-1z" clip-rule="evenodd" />
                             </svg>
                            <span>Daftar Tonton</span>
                        </button>
                    </div>
                </div>
                
                <!-- Gambar Film dengan rasio 16:9 -->
                <div class="media-container mb-6">
                    <img src="${item.backdrop_path ? `https://image.tmdb.org/t/p/w1280${item.backdrop_path}` : 'https://placehold.co/1280x720/gray/white?text=Tidak%20Ada%20Gambar'}" 
                         srcset="${backdropSrcset}"
                         sizes="(max-width: 600px) 100vw, (max-width: 900px) 780px, 1280px"
                         alt="Poster ${title}" 
                         class="w-full h-full">
                </div>

                <!-- Konten film lainnya dalam satu bagian -->
                <div class="flex flex-col md:flex-row items-start md:items-stretch gap-6">
                    <!-- Poster film di kiri, detail di kanan untuk desktop -->
                    <div class="flex-shrink-0 w-full md:w-1/3 lg:w-1/4">
                        <img src="${item.poster_path ? `https://image.tmdb.org/t/p/w500${item.poster_path}` : 'https://placehold.co/500x750/gray/white?text=Tidak%20Ada%20Poster'}" 
                             srcset="${posterSrcset}"
                             sizes="(max-width: 600px) 50vw, (max-width: 900px) 30vw, 25vw"
                             alt="Poster ${title}" 
                             class="rounded-lg shadow-md w-full h-auto">
                    </div>
                    <!-- Detail film di kanan -->
                    <div class="flex-1">
                        <h3 class="text-2xl font-bold mt-2 mb-2">Sinopsis</h3>
                        <p class="text-gray-700 mb-4 leading-relaxed text-justify">
                            ${item.overview || 'Sinopsis tidak tersedia.'}
                        </p>
                        
                        <!-- Genre dalam daftar -->
                        <h3 class="text-xl font-bold mb-2">Genre</h3>
                        <ul class="flex flex-wrap gap-2 mb-6">
                            ${genresHtml || '<li class="text-gray-500">Tidak ada genre.</li>'}
                        </ul>
                        
                        <!-- Informasi Tambahan -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <h4 class="font-semibold text-lg flex items-center space-x-2">
                                    <svg class="h-6 w-6 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h.01M7 12h.01M16 12h.01M9 16h.01M17 16h.01M6 19h12a2 2 0 002-2V7a2 2 0 00-2-2H6a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                    </svg>
                                    <span>Tanggal Rilis</span>
                                </h4>
                                <p class="text-gray-700">${releaseDate || 'N/A'}</p>
                            </div>
                            <div>
                                <h4 class="font-semibold text-lg flex items-center space-x-2">
                                    <svg class="h-6 w-6 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                    <span>Durasi</span>
                                </h4>
                                <p class="text-gray-700">${item.runtime ? `${item.runtime} mnt` : 'N/A'}</p>
                            </div>
                            <div>
                                <h4 class="font-semibold text-lg flex items-center space-x-2">
                                    <svg class="h-6 w-6 text-purple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6a2 2 0 002-2v-3a2 2 0 00-2-2H8a2 2 0 00-2 2v3a2 2 0 002 2zM9 10a2 2 0 012-2h4a2 2 0 012 2v4a2 2 0 01-2 2h-4a2 2 0 01-2-2v-4z" />
                                    </svg>
                                    <span>Kategori Audiens</span>
                                </h4>
                                <p class="text-gray-700">${certification}</p>
                            </div>
                            <div>
                                <h4 class="font-semibold text-lg flex items-center space-x-2">
                                    <svg class="h-6 w-6 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z" />
                                    </svg>
                                    <span>Bahasa Asli</span>
                                </h4>
                                <p class="text-gray-700">${getLanguageName(item.original_language)}</p>
                            </div>
                            <div>
                                <h4 class="font-semibold text-lg flex items-center space-x-2">
                                    <svg class="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9v2m0 0v2m0-2h2m-2 0H7m0 0a2 2 0 100-4 2 2 0 000 4zM15 20a2 2 0 100-4 2 2 0 000 4zM7 20a2 2 0 100-4 2 2 0 000 4zM20 7H4a2 2 0 00-2 2v8a2 2 0 002 2h16a2 2 0 002-2V9a2 2 0 00-2-2z" />
                                    </svg>
                                    <span>Anggaran</span>
                                </h4>
                                <p class="text-gray-700">${formatCurrency(item.budget)}</p>
                            </div>
                            <div>
                                <h4 class="font-semibold text-lg flex items-center space-x-2">
                                    <svg class="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c-1.105 0-2 .895-2 2s.895 2 2 2 2 .895 2 2-.895 2-2 2m0-8a4 4 0 100 8 4 4 0 000-8zM12 21a9 9 0 110-18 9 9 0 010 18z" />
                                    </svg>
                                    <span>Pendapatan</span>
                                </h4>
                                <p class="text-gray-700">${formatCurrency(item.revenue)}</p>
                            </div>
                            <!-- Detail Baru: Perusahaan Produksi -->
                            <div>
                                <h4 class="font-semibold text-lg flex items-center space-x-2">
                                    <svg class="h-6 w-6 text-orange-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                                    </svg>
                                    <span>Perusahaan Produksi</span>
                                </h4>
                                <p class="text-gray-700">${productionCompanies}</p>
                            </div>
                            <!-- Detail Baru: Status -->
                            <div>
                                <h4 class="font-semibold text-lg flex items-center space-x-2">
                                    <svg class="h-6 w-6 text-teal-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.001 12.001 0 002.92 12c0 2.887.975 5.61 2.709 7.756C7.545 20.592 9.94 21 12 21h.02c2.06-.01 4.03-.418 5.86-1.184l-1.39-1.39C15.82 19.46 13.97 19.98 12 19.98c-1.84 0-3.61-.37-5.22-1.096l1.414-1.414C8.42 17.02 10.19 17.39 12 17.39c1.84 0 3.61-.37 5.22-1.096l1.414 1.414C19.58 19.46 21.03 19.98 22 19.98c0 0 0 0 0 0V12c0-2.887-.975-5.61-2.709-7.756z" />
                                    </svg>
                                    <span>Status</span>
                                </h4>
                                <p class="text-gray-700">${item.status || 'N/A'}</p>
                            </div>
                            <!-- Detail Baru: Judul Asli -->
                            <div>
                                <h4 class="font-semibold text-lg flex items-center space-x-2">
                                    <svg class="h-6 w-6 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
                                    </svg>
                                    <span>Judul Asli</span>
                                </h4>
                                <p class="text-gray-700">${item.original_title || item.original_name || 'N/A'}</p>
                            </div>
                        </div>

                        <!-- Informasi Kru (h3) -->
                        <h3 class="text-2xl font-bold mt-6 mb-2">Pemeran & Kru Utama</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <h4 class="font-semibold text-lg">Sutradara</h4>
                                <p class="text-gray-700">
                                    ${director ? director.name : 'N/A'}
                                </p>
                            </div>
                            <div>
                                <h4 class="font-semibold text-lg">Pemeran Utama</h4>
                                <div class="grid grid-cols-2 gap-x-4 gap-y-2 text-gray-700">
                                    ${cast.length > 0 ? cast.map(actor => `
                                        <span class="font-medium">${actor.name}</span>
                                        <span class="italic">${actor.character}</span>
                                    `).join('') : '<span class="col-span-2 text-gray-500">Tidak ada pemeran utama.</span>'}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bagian Trailer -->
                <div class="mt-8">
                    <h3 class="text-2xl font-bold mb-4">Trailer</h3>
                    ${trailer ? `
                        <div class="media-container">
                            <iframe src="https://www.youtube.com/embed/${trailer.key}" 
                                    title="Pemutar video YouTube" 
                                    frameborder="0" 
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                    allowfullscreen>
                            </iframe>
                        </div>
                    ` : `
                        <p class="text-center text-gray-500">Trailer tidak tersedia untuk konten ini.</p>
                    `}
                </div>

                <!-- Bagian Ulasan Pengguna -->
                <div class="mt-8">
                    <h3 class="text-2xl font-bold mb-4">Ulasan Pengguna</h3>
                    ${reviewList || '<p class="text-center text-gray-500">Belum ada ulasan untuk konten ini.</p>'}
                </div>
            `;

            // Tambahkan event listener untuk tombol baru
            document.getElementById('share-button').onclick = () => {
                // Gunakan BLOG_URL untuk URL yang disalin
                const cleanTitle = cleanTitleForUrl(item.title || item.name);
                const urlSegment = type === 'movie' ? 'film' : 'acara-tv';
                const shareUrl = `${BLOG_URL}${urlSegment}/${cleanTitle}-${item.id}`;
                copyToClipboard(shareUrl);
            };

            document.getElementById('watchlist-button').onclick = () => {
                showMessage(`Fitur "Tambahkan ke Daftar Tonton" untuk "${title}" akan segera tersedia!`);
            };
        }

        // Fungsi baru untuk memuat detail konten dan memperbarui URL
        function loadContentDetails(id, type, title) {
            const cleanTitle = cleanTitleForUrl(title);
            const urlSegment = type === 'movie' ? 'film' : 'acara-tv'; // Mengubah segmen URL ke Bahasa Indonesia
            // Gunakan URL absolut untuk pushState
            const newUrl = `${BLOG_URL}${urlSegment}/${cleanTitle}-${id}`;
            history.pushState({ id: id, type: type, cleanTitle: cleanTitle }, cleanTitle, newUrl);
            fetchContentDetails(id, type);
        }
        
        // Fungsi untuk mengambil dan merender daftar film/acara TV
        async function fetchAndRenderList(endpoint, title, type, page = 1) {
            // Dapatkan kontainer kategori berdasarkan endpoint
            const categoryContainer = document.getElementById(`category-${endpoint}`);
            const grid = document.getElementById(`grid-${endpoint}`);

            // Jika ini bukan halaman pertama, tambahkan indikator "Memuat..."
            if (page > 1) {
                grid.insertAdjacentHTML('beforeend', `<div class="w-full text-center py-4 col-span-full text-gray-500" id="loading-more-${endpoint}">Memuat...</div>`);
            }
            
            try {
                const response = await fetch(`${TMDB_API_PROXY}/${type}/${endpoint}?page=${page}`);
                if (!response.ok) {
                    throw new Error(`Gagal mengambil data ${title}.`);
                }
                const data = await response.json();
                
                // Hapus indikator "Memuat..."
                const loadingMore = document.getElementById(`loading-more-${endpoint}`);
                if (loadingMore) {
                    loadingMore.remove();
                }

                // Jika ini adalah halaman pertama, ganti semua konten kerangka dengan daftar baru
                if (page === 1) {
                    // Gunakan `categoryContainer.innerHTML` untuk mengganti seluruh kerangka dengan konten baru
                    categoryContainer.innerHTML = `
                        <h3 class="text-2xl font-bold mb-4">${title}</h3>
                        <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4" id="grid-${endpoint}"></div>
                    `;
                }

                // Render konten. Ambil 12 film pertama jika ini adalah halaman pertama.
                const itemsToRender = data.results ? (page === 1 ? data.results.slice(0, 12) : data.results) : []; 
                renderListItems(itemsToRender, type, endpoint);
                
                // Perbarui tombol "Muat Lebih Banyak"
                let loadMoreButton = document.querySelector(`#load-more-${endpoint}`);
                if (data.page >= data.total_pages) {
                     if(loadMoreButton) loadMoreButton.remove();
                } else {
                    if (!loadMoreButton) {
                        loadMoreButton = document.createElement('button');
                        loadMoreButton.id = `load-more-${endpoint}`;
                        loadMoreButton.className = 'mt-4 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors duration-200 block mx-auto';
                        loadMoreButton.textContent = 'Muat Lebih Banyak';
                        categoryContainer.appendChild(loadMoreButton);
                        loadMoreButton.addEventListener('click', () => {
                            currentPage[endpoint]++;
                            fetchAndRenderList(endpoint, title, type, currentPage[endpoint]);
                        });
                    }
                }
            } catch (error) {
                console.error(`Gagal memuat data ${title}:`, error);
                const loadingMore = document.getElementById(`loading-more-${endpoint}`);
                if (loadingMore) {
                    loadingMore.textContent = 'Gagal memuat.';
                } else if (page === 1) {
                    // Tampilkan pesan kesalahan di dalam kontainer kategori
                    categoryContainer.innerHTML = `<p class="text-center text-red-500">Gagal memuat daftar ${title}. Silakan periksa koneksi internet Anda.</p>`;
                }
            }
        }

        // Fungsi pembantu untuk merender item ke dalam grid
        function renderListItems(items, type, endpoint) {
            const grid = document.getElementById(`grid-${endpoint}`);
            if (!grid) return; // Keluar jika grid tidak ditemukan

            items.forEach(item => {
                const posterUrl = item.poster_path ? `https://image.tmdb.org/t/p/w500${item.poster_path}` : 'https://placehold.co/500x750/gray/white?text=Tidak%20Ada%20Poster';
                const posterSrcset = `
                    https://image.tmdb.org/t/p/w92${item.poster_path} 92w,
                    https://image.tmdb.org/t/p/w185${item.poster_path} 185w,
                    https://image.tmdb.org/t/p/w342${item.poster_path} 342w,
                    https://image.tmdb.org/t/p/w500${item.poster_path} 500w
                `;
                const titleText = item.title || item.name;
                const escapedTitleText = escapeSingleQuotes(titleText); // Gunakan fungsi escape baru di sini

                const cardHtml = `
                    <div class="movie-card bg-gray-200 rounded-lg overflow-hidden shadow-md" onclick="loadContentDetails(${item.id}, '${type}', '${escapedTitleText}')">
                        <img class="w-full h-auto object-cover lazy"
                             data-src="${posterUrl}"
                             srcset="${posterSrcset}"
                             sizes="(max-width: 600px) 50vw, (max-width: 900px) 30vw, 25vw"
                             alt="Poster ${titleText}">
                        <div class="p-2 text-center">
                            <h4 class="font-semibold text-sm truncate">${titleText}</h4>
                            <p class="text-xs text-gray-600 mt-1">${item.vote_average ? item.vote_average.toFixed(1) : 'N/A'}/10</p>
                        </div>
                    </div>
                `;
                grid.insertAdjacentHTML('beforeend', cardHtml);
            });
            
            // Inisialisasi IntersectionObserver untuk lazy loading
            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        img.src = img.dataset.src;
                        img.classList.remove('lazy');
                        img.classList.add('loaded');
                        observer.unobserve(img);
                    }
                });
            });

            document.querySelectorAll(`#grid-${endpoint} img.lazy`).forEach(img => {
                observer.observe(img);
            });
        }
        
        // Fungsi untuk melakukan pencarian film atau acara TV
        async function performSearch(query) {
            const content = document.getElementById('movie-content');
            content.innerHTML = `
                <h3 class="text-2xl font-bold mb-4">Hasil Pencarian untuk "${query}"</h3>
                <div id="search-results-container"></div>
            `;
            const searchResultsContainer = document.getElementById('search-results-container');
            
            // Render kerangka untuk hasil pencarian film
            renderCategorySkeleton(`Film`, 'search-movies');
            // Render kerangka untuk hasil pencarian TV
            renderCategorySkeleton(`Acara TV`, 'search-tv');

            try {
                const [movieSearchResponse, tvSearchResponse] = await Promise.all([
                    fetch(`${TMDB_API_PROXY}/search/movie?query=${encodeURIComponent(query)}`),
                    fetch(`${TMDB_API_PROXY}/search/tv?query=${encodeURIComponent(query)}`)
                ]);
                
                if (!movieSearchResponse.ok || !tvSearchResponse.ok) {
                    throw new Error("Gagal mengambil hasil pencarian.");
                }

                const movieResults = await movieSearchResponse.json();
                const tvResults = await tvSearchResponse.json();
                
                // Render hasil film (hanya 12 film pertama)
                if (movieResults.results && movieResults.results.length > 0) {
                    const movieCategoryContainer = document.getElementById('category-search-movies');
                    movieCategoryContainer.innerHTML = `
                        <h3 class="text-2xl font-bold mb-4">Film</h3>
                        <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4" id="grid-search-movies"></div>
                    `;
                    renderListItems(movieResults.results.slice(0, 12), 'movie', 'search-movies');
                } else {
                    const movieCategoryContainer = document.getElementById('category-search-movies');
                    movieCategoryContainer.innerHTML = `<p class="text-center text-gray-500 mb-8">Tidak ada film yang ditemukan untuk "${query}".</p>`;
                }
                
                // Render hasil acara TV (hanya 12 acara TV pertama)
                if (tvResults.results && tvResults.results.length > 0) {
                    const tvCategoryContainer = document.getElementById('category-search-tv');
                    tvCategoryContainer.innerHTML = `
                        <h3 class="text-2xl font-bold mb-4">Acara TV</h3>
                        <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4" id="grid-search-tv"></div>
                    `;
                    renderListItems(tvResults.results.slice(0, 12), 'tv', 'search-tv');
                } else {
                    const tvCategoryContainer = document.getElementById('category-search-tv');
                    tvCategoryContainer.innerHTML = `<p class="text-center text-gray-500">Tidak ada acara TV yang ditemukan untuk "${query}".</p>`;
                }

            } catch (error) {
                console.error("Gagal melakukan pencarian:", error);
                renderError('Gagal melakukan pencarian. Silakan coba lagi nanti.');
            }
        }
        
        // Fungsi untuk menampilkan halaman utama
        function showHomePage() {
            const content = document.getElementById('movie-content');
            content.innerHTML = `
                <h1 id="welcome-title" class="text-3xl font-bold text-center mb-4 cursor-pointer">Selamat datang di Streamflix Now!</h1>
                <p class="text-center text-lg text-gray-600">Jelajahi film dan acara TV terbaik dari seluruh dunia. Gunakan navigasi di atas untuk memulai.</p>
                <div class="mt-8 flex justify-center">
                    <img src="https://live.staticflickr.com/65535/54695504172_16d8127e7b_b.jpg" alt="Selamat datang di Streamflix Now" class="rounded-xl shadow-lg w-full max-w-2xl h-auto">
                </div>
            `;
            // Tambahkan event listener untuk judul selamat datang yang dapat diklik
            document.getElementById('welcome-title').addEventListener('click', handleWelcomeClick);
        }

        // Fungsi untuk menangani klik pada judul "Selamat datang di Streamflix Now!"
        function handleWelcomeClick() {
            history.pushState({ page: 'welcome' }, 'Selamat Datang', `${BLOG_URL}streamflix-now`);
            showHomePage(); // Render ulang halaman utama
        }

        // Fungsi untuk menampilkan halaman Film
        async function showMoviesPage() {
            // Perbarui URL ke halaman film
            history.pushState({ page: 'movies' }, 'Film', `${BLOG_URL}film`);
            const content = document.getElementById('movie-content');
            content.innerHTML = ''; // Hapus konten lama
            
            // Render semua kerangka kategori film sebelum mengambil data
            renderCategorySkeleton('Sedang Tayang', 'now_playing');
            renderCategorySkeleton('Akan Datang', 'upcoming');
            renderCategorySkeleton('Rating Tertinggi', 'top_rated');
            renderCategorySkeleton('Populer', 'popular');
            
            // Ambil data untuk setiap kategori secara terpisah
            fetchAndRenderList('now_playing', 'Sedang Tayang', 'movie', 1);
            fetchAndRenderList('upcoming', 'Akan Datang', 'movie', 1);
            fetchAndRenderList('top_rated', 'Rating Tertinggi', 'movie', 1);
            fetchAndRenderList('popular', 'Populer', 'movie', 1);
        }

        // Fungsi untuk menampilkan halaman Acara TV
        async function showTvShowsPage() {
            // Perbarui URL ke halaman acara TV
            history.pushState({ page: 'tv-shows' }, 'Acara TV', `${BLOG_URL}acara-tv`);
            const content = document.getElementById('movie-content');
            content.innerHTML = ''; // Hapus konten lama
            
            // Render semua kerangka kategori TV sebelum mengambil data
            renderCategorySkeleton('Rating Tertinggi', 'top_rated');
            renderCategorySkeleton('Populer', 'popular');
            renderCategorySkeleton('Di TV', 'on_the_air');
            renderCategorySkeleton('Tayang Hari Ini', 'airing_today');
            
            // Ambil data untuk setiap kategori secara terpisah
            fetchAndRenderList('top_rated', 'Rating Tertinggi', 'tv', 1);
            fetchAndRenderList('popular', 'Populer', 'tv', 1);
            fetchAndRenderList('on_the_air', 'Di TV', 'tv', 1);
            fetchAndRenderList('airing_today', 'Tayang Hari Ini', 'tv', 1);
        }

        // Logika utama saat halaman dimuat
        document.addEventListener('DOMContentLoaded', () => {
            // Pastikan tema gelap tidak diterapkan
            document.documentElement.classList.remove('dark');

            // Tambahkan event listener untuk navigasi
            document.getElementById('home-button').addEventListener('click', () => {
                history.pushState({ page: 'home' }, 'Beranda', `${BLOG_URL}beranda`); // Gunakan URL absolut
                showHomePage();
            });
            document.getElementById('movies-nav').addEventListener('click', showMoviesPage);
            document.getElementById('tv-shows-nav').addEventListener('click', showTvShowsPage);
            
            // Tambahkan event listener untuk formulir pencarian
            document.getElementById('search-form').addEventListener('submit', (event) => {
                event.preventDefault();
                const query = document.getElementById('search-input').value;
                if (query.trim() !== '') {
                    // Perbarui URL untuk hasil pencarian
                    history.pushState({ page: 'search', query: query }, `Pencarian: ${query}`, `${BLOG_URL}cari/${encodeURIComponent(query)}`); // Mengubah segmen URL ke Bahasa Indonesia
                    performSearch(query.trim());
                }
            });

            // Tangani navigasi maju/mundur browser
            window.addEventListener('popstate', (event) => {
                if (event.state) {
                    // Jika ada state yang didorong oleh kita, gunakan itu
                    if (event.state.page === 'home' || event.state.page === 'welcome') { // Tangani kedua state home dan welcome
                        showHomePage();
                    } else if (event.state.page === 'movies') {
                        showMoviesPage();
                    } else if (event.state.page === 'tv-shows') {
                        showTvShowsPage();
                    } else if (event.state.page === 'search') {
                        performSearch(event.state.query);
                    } else if (event.state.id && event.state.type) {
                        // Ini adalah halaman detail film/acara TV
                        fetchContentDetails(event.state.id, event.state.type);
                    }
                } else {
                    // Jika tidak ada state, mungkin ini adalah pemuatan awal atau URL yang diketik langsung
                    const path = window.location.pathname;
                    const parts = path.split('/').filter(part => part !== ''); // Filter bagian kosong
                    
                    if (parts.length === 0 || parts[0] === 'index.html' || parts[0] === 'beranda' || parts[0] === 'streamflix-now') { // Tangani semua path terkait home
                        showHomePage();
                    } else if (parts[0] === 'film' && parts.length === 2) { // Mengubah segmen URL ke Bahasa Indonesia
                        const idPart = parts[1];
                        const id = parseInt(idPart.split('-').pop());
                        if (!isNaN(id)) {
                            fetchContentDetails(id, 'movie');
                        } else {
                            showHomePage(); // Fallback jika ID tidak valid
                        }
                    } else if (parts[0] === 'acara-tv' && parts.length === 2) { // Mengubah segmen URL ke Bahasa Indonesia
                        const idPart = parts[1];
                        const id = parseInt(idPart.split('-').pop());
                        if (!isNaN(id)) {
                            fetchContentDetails(id, 'tv');
                        } else {
                            showHomePage(); // Fallback jika ID tidak valid
                        }
                    } else if (parts[0] === 'cari' && parts.length === 2) { // Mengubah segmen URL ke Bahasa Indonesia
                        performSearch(decodeURIComponent(parts[1]));
                    } else {
                        showHomePage(); // Fallback untuk URL yang tidak dikenali
                    }
                }
            });

            // Panggil penanganan popstate untuk memuat konten awal berdasarkan URL
            window.dispatchEvent(new PopStateEvent('popstate', { state: null }));
        });
    </script>
</body>
</html>
